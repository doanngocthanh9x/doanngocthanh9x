{
  "posts": [
  {% assign all_posts = site.posts | sort: 'date' | reverse %}
  {% if page.page_number and page.page_size %}
    {% assign start = page.page_number | minus: 1 | times: page.page_size %}
    {% assign posts = all_posts | slice: start, page.page_size %}
  {% elsif page.offset and page.limit %}
    {% assign posts = all_posts | slice: page.offset, page.limit %}
  {% elsif page.limit %}
    {% assign posts = all_posts | slice: 0, page.limit %}
  {% else %}
    {% assign posts = all_posts %}
  {% endif %}

  {% for post in posts %}
    {
      "title": {{ post.title | jsonify }},
      "url": {{ post.url | absolute_url | jsonify }},
      "date": {{ post.date | date_to_xmlschema | jsonify }},
      "excerpt": {{ post.excerpt | strip_html | strip_newlines | jsonify }},
      "content": {{ post.content | strip_html | strip_newlines | jsonify }},
      "image": {{ post.image | default: "" | jsonify }},
      "thumbnail": {{ post.thumbnail | default: post.image | default: "" | jsonify }},
      "categories": {{ post.categories | jsonify }},
      "tags": {{ post.tags | jsonify }}
    }{% if forloop.last == false %},{% endif %}
  {% endfor %}
  ]
}

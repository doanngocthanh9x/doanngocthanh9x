{
  "posts": [
  {% assign all_posts = site.posts | sort: 'date' | reverse %}
  {% if page.page_number and page.page_size %}
    {% assign start = page.page_number | minus: 1 | times: page.page_size %}
    {% assign posts = all_posts | slice: start, page.page_size %}
  {% elsif page.offset and page.limit %}
    {% assign posts = all_posts | slice: page.offset, page.limit %}
  {% elsif page.limit %}
    {% assign posts = all_posts | slice: 0, page.limit %}
  {% else %}
    {% assign posts = all_posts %}
  {% endif %}

  {% for post in posts %}
    {
      "title": {{ post.title | jsonify }},
      "url": {{ post.url | absolute_url | jsonify }},
      "date": {{ post.date | date_to_xmlschema | jsonify }},
      "excerpt": {{ post.excerpt | strip_html | strip_newlines | jsonify }},
      "content_markdown": {{ post.content | jsonify }},
      "content_html": {{ post.content | markdownify | jsonify }},
      "content_format": "markdown",
      "image": {{ post.image | default: "" | jsonify }},
      "thumbnail": {{ post.thumbnail | default: post.image | default: "" | jsonify }},
      "meta_title": {{ post.data.meta_title | default: post.title | jsonify }},
      "meta_description": {{ post.data.meta_description | default: post.excerpt | strip_html | strip_newlines | jsonify }},
      "og_image": {{ post.data.og_image | default: post.image | default: "" | jsonify }},
      "canonical_url": {{ post.url | absolute_url | jsonify }},
      "categories": {{ post.categories | jsonify }},
      "tags": {{ post.tags | jsonify }}
    }{% if forloop.last == false %},{% endif %}
  {% endfor %}
  ]
}
